<!DOCTYPE HTML>
<html>
  <head>
    <link rel="stylesheet" href="../../Scanner/styles.css">
  </head>
  <body>
    <span class="token-1">//Autor: Oscar Jahir Valdés Caballero</span>
    <br>
    <span class="token-1">//Última modificación: 30 de marzo de 2022</span>
    <br>
    <span class="token-1">//Descripción: Este programa es la función principal del analizador lexico, su output es un archivo con el nombre "index.html" el cual resalta las expresiones regulares encontradas en el archivo "text.txt".</span>
    <br>
    <br>
    <span class="token-7">#include</span>
    <span class="token-17"> </span>
    <span class="token-8"><</span>
    <span class="token-15">stdio</span>
    <span class="token-8">.</span>
    <span class="token-15">h</span>
    <span class="token-8">></span>
    <br>
    <span class="token-7">#include</span>
    <span class="token-17"> </span>
    <span class="token-8"><</span>
    <span class="token-15">string</span>
    <span class="token-8">.</span>
    <span class="token-15">h</span>
    <span class="token-8">></span>
    <br>
    <br>
    <br>
    <span class="token-1">//Funciones y punteros del archivo lex.yy.c generado por flex</span>
    <br>
    <span class="token-7">extern</span>
    <span class="token-17"> </span>
    <span class="token-7">int</span>
    <span class="token-17"> </span>
    <span class="token-15">yylex</span>
    <span class="token-8">(</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-7">extern</span>
    <span class="token-17"> </span>
    <span class="token-7">int</span>
    <span class="token-17"> </span>
    <span class="token-15">yylineno</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-7">extern</span>
    <span class="token-17"> </span>
    <span class="token-7">char</span>
    <span class="token-17"> </span>
    <span class="token-5">*</span>
    <span class="token-15">yytext</span>
    <span class="token-8">;</span>
    <br>
    <br>
    <span class="token-7">char</span>
    <span class="token-17"> </span>
    <span class="token-15">header</span>
    <span class="token-8">[</span>
    <span class="token-8">]</span>
    <span class="token-17"> </span>
    <span class="token-5">=</span>
    <span class="token-17"> </span>
    <span class="token-1">//Encabezado del archivo html</span>
    <br>
    <span class="token-3">"<!DOCTYPE HTML>\n"</span>
    <br>
    <span class="token-3">"<html>\n"</span>
    <br>
    <span class="token-3">"  <head>\n"</span>
    <br>
    <span class="token-3">"    <link rel=\"stylesheet\" href=\"../../Scanner/styles.css\">\n"</span>
    <br>
    <span class="token-3">"  </head>\n"</span>
    <br>
    <span class="token-3">"  <body>\n"</span>
    <span class="token-8">;</span>
    <br>
    <br>
    <span class="token-7">char</span>
    <span class="token-17"> </span>
    <span class="token-15">footer</span>
    <span class="token-8">[</span>
    <span class="token-8">]</span>
    <span class="token-17"> </span>
    <span class="token-5">=</span>
    <span class="token-17"> </span>
    <span class="token-1">//Pie del archivo html</span>
    <br>
    <span class="token-3">"  </body>\n"</span>
    <br>
    <span class="token-3">"</html>"</span>
    <span class="token-8">;</span>
    <br>
    <br>
    <span class="token-7">int</span>
    <span class="token-17"> </span>
    <span class="token-15">main</span>
    <span class="token-8">(</span>
    <span class="token-7">int</span>
    <span class="token-17"> </span>
    <span class="token-15">argc</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-7">char</span>
    <span class="token-17"> </span>
    <span class="token-5">*</span>
    <span class="token-5">*</span>
    <span class="token-15">argv</span>
    <span class="token-8">)</span>
    <span class="token-8">{</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-7">char</span>
    <span class="token-17"> </span>
    <span class="token-15">file_name_output</span>
    <span class="token-8">[</span>
    <span class="token-13">99</span>
    <span class="token-8">]</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">strcpy</span>
    <span class="token-8">(</span>
    <span class="token-15">file_name_output</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-15">argv</span>
    <span class="token-8">[</span>
    <span class="token-13">1</span>
    <span class="token-8">]</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-1">//printf("Voy a guardar el archivo con el nombre: %s\n", file_name_output);</span>
    <br>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-7">int</span>
    <span class="token-17"> </span>
    <span class="token-15">ntoken</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Entero que identifica el tipo de token de acuerdo a la línea en que se encuentra la expresión regular que lo genera en el archivo "patterns.txt".</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">FILE</span>
    <span class="token-17"> </span>
    <span class="token-5">*</span>
    <span class="token-15">fptr</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Puntero al archivo output.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">fptr</span>
    <span class="token-17"> </span>
    <span class="token-5">=</span>
    <span class="token-17"> </span>
    <span class="token-15">fopen</span>
    <span class="token-8">(</span>
    <span class="token-15">file_name_output</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-3">"w"</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Se abre el archivo html en modo escritura.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">fprintf</span>
    <span class="token-8">(</span>
    <span class="token-15">fptr</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-3">"%s"</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-15">header</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Se escribe en el encabezado del archivo.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <br>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">ntoken</span>
    <span class="token-17"> </span>
    <span class="token-5">=</span>
    <span class="token-17"> </span>
    <span class="token-15">yylex</span>
    <span class="token-8">(</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Se lee el primer token del archivo "text.txt".</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-7">while</span>
    <span class="token-17"> </span>
    <span class="token-8">(</span>
    <span class="token-15">ntoken</span>
    <span class="token-8">)</span>
    <span class="token-17"> </span>
    <span class="token-1">//Mientras el lexer siga generando tokens.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-8">{</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-7">if</span>
    <span class="token-17"> </span>
    <span class="token-8">(</span>
    <span class="token-15">strcmp</span>
    <span class="token-8">(</span>
    <span class="token-15">yytext</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-3">"\n"</span>
    <span class="token-8">)</span>
    <span class="token-6">==</span>
    <span class="token-13">0</span>
    <span class="token-8">)</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-8">{</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-1">//Para introducir saltos de línea es necesario sustituir el carácter salto de línea por la etiqueta html <br>.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">fprintf</span>
    <span class="token-8">(</span>
    <span class="token-15">fptr</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-3">"    <br>\n"</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-8">}</span>
    <span class="token-7">else</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-8">{</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-1">//Si no se encuentra un salto de línea se genera una etiqueta html <span> con los contenidos del token y una clase definida por el tipo de token, el cual se obtiene a través de la función yylex.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">fprintf</span>
    <span class="token-8">(</span>
    <span class="token-15">fptr</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-3">"    <span class=\"token-%d\">%s</span>\n"</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-15">ntoken</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-15">yytext</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-8">}</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">ntoken</span>
    <span class="token-17"> </span>
    <span class="token-5">=</span>
    <span class="token-17"> </span>
    <span class="token-15">yylex</span>
    <span class="token-8">(</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Se lee el siguiente token.</span>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-8">}</span>
    <br>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">fprintf</span>
    <span class="token-8">(</span>
    <span class="token-15">fptr</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-3">"%s"</span>
    <span class="token-8">,</span>
    <span class="token-17"> </span>
    <span class="token-15">footer</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Se escribe en el pie del archivo.</span>
    <br>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-15">fclose</span>
    <span class="token-8">(</span>
    <span class="token-15">fptr</span>
    <span class="token-8">)</span>
    <span class="token-8">;</span>
    <span class="token-17"> </span>
    <span class="token-1">//Se cierra el archivo antes de finalizar el programa.</span>
    <br>
    <br>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-17"> </span>
    <span class="token-7">return</span>
    <span class="token-17"> </span>
    <span class="token-13">1</span>
    <span class="token-8">;</span>
    <br>
    <span class="token-8">}</span>
  </body>
</html>